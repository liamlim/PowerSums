\documentclass[12pt]{article}
\usepackage{amsmath, amsthm, amssymb}
\usepackage{hyperref}
\usepackage{geometry}
\geometry{margin=1in}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}

\title{Weighted Power Sums, $K/L/M$ Basis Functions, and $T_n$}
\author{}
\date{}

\begin{document}
	\maketitle
	\tableofcontents
	\newpage
	
	% -----------------------------------------------------------------------
	\section{Setup and Assumptions}
	
	Throughout, we assume $x, y, z$ are distinct and non-zero. In particular
	$e_3 = xyz \neq 0$, which allows us to extend recurrences backwards to
	all integers.
	
	\subsection{Elementary symmetric polynomials}
	
	\begin{definition}
		\begin{align*}
			e_1 &= x + y + z, \\
			e_2 &= xy + yz + zx, \\
			e_3 &= xyz.
		\end{align*}
	\end{definition}
	
	These are the coefficients of the minimal polynomial of $x, y, z$:
	\[
	(t - x)(t - y)(t - z) = t^3 - e_1 t^2 + e_2 t - e_3.
	\]
	
	\subsection{Helper differences}
	
	\begin{definition}
		\[
		w_x = y - z, \qquad w_y = z - x, \qquad w_z = x - y.
		\]
	\end{definition}
	
	Note that $w_x + w_y + w_z = 0$, and all three are nonzero since $x, y,
	z$ are distinct.
	
	% -----------------------------------------------------------------------
	\section{Weighted Power Sums $f_n$}
	
	\begin{definition}
		For any integer $n$ and weights $k, l, m$, define
		\[
		f_n(k,l,m) = k x^n + l y^n + m z^n.
		\]
		This is well-defined for all integers $n$ because $x, y, z \neq 0$.
		We write $s_n = f_n(1,1,1) = x^n + y^n + z^n$ for the standard power
		sums.
	\end{definition}
	
	\begin{theorem}[Recurrence for $f_n$]
		For any integer $n$ and any fixed weights $k, l, m$,
		\[
		f_{n+3}(k,l,m) = e_1\, f_{n+2}(k,l,m) - e_2\, f_{n+1}(k,l,m)
		+ e_3\, f_n(k,l,m).
		\]
	\end{theorem}
	\begin{proof}
		Each of $x, y, z$ satisfies $t^3 = e_1 t^2 - e_2 t + e_3$, so the
		same recurrence holds for $x^n, y^n, z^n$ individually, and hence for
		any weighted sum.
	\end{proof}
	
	% -----------------------------------------------------------------------
	\section{The Function $K(n)$}
	
	\subsection{Evaluating $f_n$ at weights $(w_x, w_y, w_z)$}
	
	\begin{lemma}
		\begin{align*}
			f_0(w_x, w_y, w_z) &= 0, \\
			f_1(w_x, w_y, w_z) &= 0, \\
			f_2(w_x, w_y, w_z) &= -w_x w_y w_z = -(y-z)(z-x)(x-y).
		\end{align*}
		In particular, $f_2(w_x, w_y, w_z) \neq 0$ since $x,y,z$ are distinct.
	\end{lemma}
	\begin{proof}
		$f_0 = w_x + w_y + w_z = 0$ by definition. For $f_1$:
		$w_x x + w_y y + w_z z = x(y-z) + y(z-x) + z(x-y) = 0$. The identity
		for $f_2$ is a standard Vandermonde-type calculation.
	\end{proof}
	
	\begin{definition}
		For any integer $n$, define
		\[
		K(n) = \frac{f_n(w_x, w_y, w_z)}{f_2(w_x, w_y, w_z)}.
		\]
	\end{definition}
	
	\subsection{Initial values and recurrence}
	
	\begin{lemma}
		$K(0) = 0$, $K(1) = 0$, $K(2) = 1$.
	\end{lemma}
	
	\begin{theorem}[Recurrence for $K$]
		\[
		K(n+3) = e_1\, K(n+2) - e_2\, K(n+1) + e_3\, K(n).
		\]
	\end{theorem}
	\begin{proof}
		Inherited from the recurrence for $f_n$ by linearity and division by
		the nonzero constant $f_2(w_x, w_y, w_z)$.
	\end{proof}
	
	% -----------------------------------------------------------------------
	\section{The Functions $L(n)$ and $M(n)$}
	
	\begin{definition}
		\[
		L(n) = K(n+1) - e_1\, K(n), \qquad M(n) = e_3\, K(n-1).
		\]
	\end{definition}
	
	\begin{lemma}[Initial values]
		\begin{align*}
			L(0) &= 0, & L(1) &= 1, & L(2) &= 0, \\
			M(0) &= 1, & M(1) &= 0, & M(2) &= 0.
		\end{align*}
	\end{lemma}
	\begin{proof}
		Direct computation. For $L$: $L(0) = K(1) - e_1 K(0) = 0$,
		$L(1) = K(2) - e_1 K(1) = 1$, $L(2) = K(3) - e_1 K(2) = e_1 - e_1 =
		0$. For $M$: $M(1) = e_3 K(0) = 0$, $M(2) = e_3 K(1) = 0$, and
		$M(0) = e_3 K(-1) = 1$ since the recurrence backwards gives $K(-1) =
		1/e_3$.
	\end{proof}
	
	\begin{theorem}[Recurrences for $L$ and $M$]
		Both $L$ and $M$ satisfy
		\[
		a(n+3) = e_1\, a(n+2) - e_2\, a(n+1) + e_3\, a(n).
		\]
	\end{theorem}
	\begin{proof}
		Both are linear combinations of shifts of $K$, so they inherit the
		recurrence.
	\end{proof}
	
	\subsection*{Initial value summary}
	
	\[
	\begin{array}{c|ccc}
		n   & 0 & 1 & 2 \\\hline
		K(n) & 0 & 0 & 1 \\
		L(n) & 0 & 1 & 0 \\
		M(n) & 1 & 0 & 0
	\end{array}
	\]
	
	The triplet $(K(n), L(n), M(n))$ at $n = 0, 1, 2$ forms the identity
	matrix: $K, L, M$ are the standard basis for all sequences satisfying
	the recurrence.
	
	% -----------------------------------------------------------------------
	\section{Decomposition of $f_n$ in the $K, L, M$ Basis}
	
	\begin{theorem}
		For any weights $k, l, m$ and any integer $n$,
		\[
		f_n(k,l,m) = K(n)\, f_2(k,l,m) + L(n)\, f_1(k,l,m)
		+ M(n)\, f_0(k,l,m).
		\]
	\end{theorem}
	\begin{proof}
		Both sides satisfy the same recurrence. At $n = 0, 1, 2$ both sides
		agree by the initial values of $K, L, M$. Equality for all integers
		$n$ follows from uniqueness of recurrence solutions.
	\end{proof}
	
	% -----------------------------------------------------------------------
	\section{The Function $T_n$}
	
	\begin{definition}
		For any weights $k, l, m$ and any integer $n$, define
		\[
		T_n(k,l,m) = k\, K(n+2) + l\, L(n+1) + m\, M(n).
		\]
		We write $t_n = T_n(1,1,1) = K(n+2) + L(n+1) + M(n)$.
	\end{definition}
	
	\begin{theorem}[Recurrence for $T_n$]
		\[
		T_{n+3}(k,l,m) = e_1\, T_{n+2}(k,l,m) - e_2\, T_{n+1}(k,l,m)
		+ e_3\, T_n(k,l,m).
		\]
	\end{theorem}
	
	\begin{theorem}[Decomposition of $T_n$]
		\[
		T_n(k,l,m) = K(n)\, T_2(k,l,m) + L(n)\, T_1(k,l,m)
		+ M(n)\, T_0(k,l,m).
		\]
	\end{theorem}
	\begin{proof}
		Same argument as for $f_n$: both sides satisfy the recurrence and
		agree at $n = 0, 1, 2$.
	\end{proof}
	
	% -----------------------------------------------------------------------
	\section{Explicit Values of $T_0, T_1, T_2$ and the Identity $s_n = t_n$}
	
	\subsection{Computing $T_0$, $T_1$, $T_2$}
	
	Using $K(3) = e_1$, $K(4) = e_1^2 - e_2$, $L(3) = -e_2$:
	
	\begin{align*}
		T_0(k,l,m) &= k + l + m, \\
		T_1(k,l,m) &= k\, e_1, \\
		T_2(k,l,m) &= k(e_1^2 - e_2) - l\, e_2.
	\end{align*}
	
	\subsection{Specializing to $t_n = T_n(1,1,1)$}
	
	\[
	t_0 = 3, \qquad t_1 = e_1, \qquad t_2 = e_1^2 - 2e_2.
	\]
	
	These coincide with $s_0, s_1, s_2$.
	
	\begin{theorem}
		$s_n = t_n$ for all integers $n$.
	\end{theorem}
	\begin{proof}
		Both sequences satisfy the same recurrence and agree at $n = 0, 1, 2$.
	\end{proof}
	
	\begin{corollary}
		For all integers $n$,
		\[
		x^n + y^n + z^n = K(n+2) + L(n+1) + M(n).
		\]
	\end{corollary}
	
	% -----------------------------------------------------------------------
	\section{When Does $f_n(k,l,m) = T_n(k,l,m)$?}
	
	Since both $f_n$ and $T_n$ satisfy the same recurrence, equality for all
	$n$ is equivalent to equality at $n = 0, 1, 2$.
	
	\begin{itemize}
		\item $n=0$: $f_0 = T_0$ always holds (both equal $k+l+m$).
		\item $n=1$: $f_1 = T_1$ requires $kx + ly + mz = k\,e_1$, i.e.
		\[
		ly + mz = k(y+z).
		\]
		\item $n=2$: given the $n=1$ condition, $f_2 = T_2$ reduces (after
		substituting $l = k + \lambda$, $m = k - \lambda y/z$) to
		\[
		y^2 + xy + zx = 0.
		\]
	\end{itemize}
	
	\begin{theorem}
		Suppose $y + z \neq 0$. Set
		\[
		x = -\frac{y^2}{y+z}, \qquad k = \frac{ly + mz}{y+z}.
		\]
		Then $f_n(k,l,m) = T_n(k,l,m)$ for all integers $n$.
	\end{theorem}
	\begin{proof}
		The two conditions above are satisfied by construction, so $f_n = T_n$
		holds at $n = 0, 1, 2$, and hence for all $n$ by the recurrence.
	\end{proof}
	
	\begin{remark}
		$y, z, l, m$ are free parameters (with $y + z \neq 0$); $x$ and $k$
		are then uniquely determined. Note that $x \neq z$ is automatic for
		real $y, z$ (it would require $y^2 + yz + z^2 = 0$, which has no real
		nonzero solutions). The asymmetry in $x$ is by design: $T_n$ privileges
		the weight $k$ (associated to $x$).
	\end{remark}
	
	% -----------------------------------------------------------------------
	\section{Matching $T_n$ to $K$, $L$, $M$}
	
	\subsection{Matching $T_n(k,l,m) = K(n)$}
	
	Requiring $T_n(k,l,m) = K(n)$ at $n = 0,1,2$ (and hence for all $n$):
	
	\begin{align*}
		T_0 = K(0) = 0 &\implies k + l + m = 0, \\
		T_1 = K(1) = 0 &\implies k = 0, \\
		T_2 = K(2) = 1 &\implies -l\, e_2 = 1 \implies l = -\tfrac{1}{e_2},
		\quad m = \tfrac{1}{e_2}.
	\end{align*}
	
	\begin{theorem}
		$T_n\!\left(0,\, -\tfrac{1}{e_2},\, \tfrac{1}{e_2}\right) = K(n)$
		for all integers $n$.
	\end{theorem}
	
	\begin{corollary}
		\[
		e_2\, K(n) = M(n) - L(n+1) \qquad \text{for all integers } n.
		\]
	\end{corollary}
	\begin{proof}
		Substitute the weights into the definition of $T_n$.
	\end{proof}
	
\end{document}